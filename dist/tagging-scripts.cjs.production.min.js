"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=require("ramda"),e=require("lodash"),i=function n(i,t){var r;return void 0===t&&(t=[]),e.isObject(i)?e.reduce(i,(function(i,r,a){return e.merge(i,n(r,[].concat(t,[a])))}),{}):((r={})[t.join(".")]=i,r)},t=function(n,e){return n.replaceAll(/\{([^}]+)\}/gi,(function(n,i){return i.split(".").reduce((function(n,e){return null==n?void 0:n[e]}),e)}))},r=function(n){return(n||window.location).pathname},a={},o=function(n,i){var t=(void 0).eventLabel;e.set(window,"__TAG_DATA__LAYER",i);var r=e.get(n,t,n.type||"event");Object.values({}).forEach((function(n){new Function("eventName","data",n)(r,i)}))},s=function(){var n=u();if(n&&e.isEmpty(null==n?void 0:n.dynamicKeys)){var i=d(!0);e.isEmpty(i)||o(n,i)}},c=n.memoizeWith(n.toUpper,(function(e){return n.find(n.propEq(e,"id"))((void 0).pages)})),u=function(){var n=r(),e=c(n);if(e)return e},d=function(o){var s=u();if(s){var c,d=s.rules,f=s.tag,v=s.dynamicKeys,l=(c=r(),e.get(a,c,{})),p=e.merge({},l,f,{},{});if(!n.isEmpty(v)){var m=Object.keys(l),y=n.difference(v,m);n.isEmpty(y)||console.warn("[page]missing dynamic keys",y)}var g=i(d),w=n.mapObjIndexed((function(n){return t(n,p)}),g);if(o){var E={};return n.forEachObjIndexed((function(n,i){e.set(E,i,n)}),w),E}return w}};exports.default=function(a){if(a){console.log("Tagging is running");var c=window.history.pushState;window.history.pushState=function(){var n=r(window.location);c.apply(window.history,arguments);var e=r(window.location);n!==e&&s()},window.addEventListener("popstate",(function(){s()})),document.addEventListener("click",(function(r){var a,s;!function(r){var a=r.dataset,s=void 0===a?{}:a,c=r.classList,f=r.id,v=u();if(v){var l=function(e,i){if(i||(i=u()),i){var t=n.find(n.anyPass([n.propEq(e.id,"id"),n.propSatisfies((function(n){var i;return null==(i=e.classList)?void 0:i.contains(n)}),"class")]))(i.actions.clicks);if(t)return t}}({classList:c,id:f},v);if(l){var p=d()||{},m=function(r,a,o){var s=r.rules,c=r.tag,d=r.dynamicKeys;if(!n.isEmpty(d)){var f=Object.keys(o),v=n.difference(d,f);n.isEmpty(v)||console.warn("[clickable]missing dynamic keys",v)}var l=function(){var n=u();if(n)return n.tag}(),p=e.merge({},o,l,c,{},{}),m=i(s);return n.mapObjIndexed((function(n){return t(n,p)}),m)}(l,0,s),y=e.merge({},p,m),g={};n.forEachObjIndexed((function(n,i){e.set(g,i,n)}),y),o(l,g)}}}((a=r.target,s=a.classList,{dataset:a.dataset,classList:void 0===s?[]:s,id:a.id}))}),!0)}};
//# sourceMappingURL=tagging-scripts.cjs.production.min.js.map
